---
# Tasks file for skynetlabs.skynet_webportal

# Run as root or root like user

- name: Check supported OS and version
  assert:
    that:
      - ansible_distribution|lower == 'debian' and ansible_distribution_version == '10'
    fail_msg: "{{ ansible_distribution }} {{ ansible_distribution_version }} is not yet supported by this role"

- name: "Setup server: apt update, install packages, set timezone"
  ansible.builtin.import_tasks: server.yml
  become: True

- name: "Setup user: Create user, upload local SSH key, set user filelimits"
  ansible.builtin.import_tasks: user.yml
  become: True

# Run as portal user

- name: Set Ansible user to webportal user
  set_fact:
    ansible_user: "{{ webportal_user }}"

- command: pwd
  register: result

- debug:
    msg: "{{ result.stdout }}"